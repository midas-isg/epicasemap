@import tags._

@imports = {
	@script_asset("external_packages/angular-1.4.3.js")
	@script_asset("external_packages/underscore-min-1.8.3.js")
	@script_asset("javascripts/ng/app-api.js")
	@script_asset("javascripts/ng/controllers/vizs.js")
	@script_asset("javascripts/ng/controllers/viz.js")
	<base href="/">
}

@main("Viz Management", imports) {
	<article ng-app='app' ng-controller='Vizs'>
		@vizManagement()
	</article>
}

@vizManagement() = {
	<section>
		<h2>Create a new Viz</h2>
		<button class='btn-large' ng-click='addNew()'>@bs_icon("plus") Add new
		</button>
	</section>
	<section>
		<h2>Edit existing {{count(vizs)}} Vizs</h2>
		@filters("viz", "Vizs", Seq(Seq("id", "ID"), Seq("name", "Name")))
		<table class='table table-striped table-condensed table-hover'>
			<thead> <tr>
					<th>ID</th>
					<th>Name</th>
					<th>|Series 1|</th>
					<th>|Series 2|</th>
			</tr></thead>
			<tbody>
				<tr class='active' ng-repeat=@filter_repeat("viz in vizs", "viz")>
					<td>{{viz.id}}</td>
					<td>
						<button title='edit' class='btn btn-xs' ng-click='edit(viz)'>
							@bs_icon("edit")
						</button> 
						{{viz.name}}
					</td>
					<td>{{count(viz.allSeries)}}</td>
					<td>{{count(viz.allSeries2)}}</td>
				</tr>
			</tbody>
		</table>
	</section>
	@viz_dialog("Viz Editor")
}
